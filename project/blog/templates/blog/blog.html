{% load staticfiles %}
{% include 'main/header.html' %}

<section id="indexsection">
    <div id="content" class="blog_main">
        <a id = "write_button" href="{% url 'write' %}"><button> <p><img src="{% static 'img/write.png' %}"></p> </button></a>
        <div class="indexcontent" id="search">
            <h1>
                Search
            </h1>
            <div>
                <h3>For Titles</h3>
                <div id="search_for_title">
                    <input name="search_title" placeholder="What is Love?">
                    <button type="button" id="search_title"> GO </button>
                </div>
            </div>
            <div>
                <h3>For Tags</h3>
                <div id="search_for_tags">
                    <input name="search_tag" placeholder="We Can Fly">
                    <button type="button" id="search_tag"> GO </button>

                    <h4>Tag Ranking</h4>
                    {% if tags %}
                    <ul>
                        {% for x in tags %}
                        <li>
                            <span class='hashtag'>{{ x.title }}</span>
                            <span> tagged for <strong>{{ x.nou }}</strong> times.</span>
                        </li>
                        {% endfor %}
                    </ul>
                    {% else %}
                    <span>Oops! There is not any tag.</span>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="indexcontent" id="recent_posts">
            <h1>
                Recent Posts
            </h1>
            <table class="table">
                <colgroup>
                    <col class="text-center" style="width: 15%;">
                    <col style="">
                    <col style="width: 15%;">
                    <col style="width: 10%;">
                </colgroup>
                <thead>
                <tr>
                    <th class="text-center">번호</th>
                    <th class="text-center">글 제목</th>
                    <th class="text-center">작성일</th>
                    <th class="text-center">조회수</th>
                </tr>
                </thead>
                <tbody>
                {% for post in recent_posts %}
                <tr id="{{ post.id }}" class="post_index">
                    <td class="text-center">{{ post.id }}</td>
                    <td>{{ post.title }}&nbsp;&nbsp;<span class="noc">({{ post.noc}})</span></td>
                    <td class="text-center">{{ post.published_date }}</td>
                    <td class="text-center">{{ post.hits }}</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>

        </div>
    </div>
    <script>

            $('.post_index').click(function() {
                location.href = "/post/" + $(this).attr('id');
            });

            $('.hashtag').click(function() {
                url = '/tags/' + $(this).text();
                location.href = url;
            });

            $('#search_title').click(function() {
                url = '/search/' + $('input[name=search_title]').val();
                location.href = url;
            });

            $('#search_tag').click(function() {
                url = '/tags/' + $('input[name=search_tag]').val();
                location.href = url;
            });

        </script>
</section>

{% include 'main/footer.html' %}